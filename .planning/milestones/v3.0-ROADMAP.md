# Milestone v3.0: Daily Driver

**Status:** âœ… SHIPPED 2026-02-01
**Phases:** 09-15
**Total Plans:** 26

## Overview

Make P4Now reliable enough for real contributors to evaluate with their daily Perforce workflows. Added E2E testing, bug fixes, auto-refresh, three-column layout, search filtering, workspace/stream switching, depot browser, and conflict resolution.

## Phases

### Phase 09: E2E Testing Foundation
**Goal**: Automated regression testing infrastructure for core workflows
**Depends on**: Nothing (parallel track)
**Plans**: 3 plans

Plans:
- [x] 09-01: E2E infrastructure setup + data-testid attributes
- [x] 09-02: E2E test specs for all core workflows
- [x] 09-03: Pre-seed P4 connection settings for automated test startup

### Phase 10: Bug Fixes
**Goal**: Stabilize existing features before adding new complexity
**Depends on**: Nothing (touches existing code)
**Plans**: 2 plans

Plans:
- [x] 10-01: Fix drag-drop reliability, default CL file movement, refresh button
- [x] 10-02: Fix unshelve target CL + resolve detection after unshelve

### Phase 11: Auto-Refresh + Settings
**Goal**: Configurable periodic polling with smart operation gating
**Depends on**: Phase 10
**Plans**: 2 plans

Plans:
- [x] 11-01: Settings schema extension + useWindowFocus hook + auto-refresh query wiring
- [x] 11-02: Tauri dialog plugin + SettingsDialog UI (editor path, auto-refresh interval)

### Phase 11.1: Unified Three-Column Layout (INSERTED)
**Goal**: Revamp main window to three-column layout with selection-driven detail views
**Depends on**: Phase 11
**Plans**: 5 plans

Plans:
- [x] 11.1-01: Selection store + three-column layout skeleton
- [x] 11.1-02: WorkspaceSummaryView + FileDetailView with inline history
- [x] 11.1-03: ChangelistDetailView + RevisionDetailView
- [x] 11.1-04: Breadcrumb navigation + wire side column selections
- [x] 11.1-05: Column width persistence + cleanup + visual verification

### Phase 12: Search Filtering & Results
**Goal**: In-place search filtering of file tree and changelist columns with command palette for deep searches
**Depends on**: Phase 11.1
**Plans**: 4 plans

Plans:
- [x] 12-01: Search filter store + rewire SearchBar for in-place filtering
- [x] 12-02: Wire fuzzy filtering into FileTree and ChangelistPanel (dim/highlight)
- [x] 12-03: Command palette deep search commands + detail pane search results
- [x] 12-04: Visual polish (tint, result-click dismiss) + verification checkpoint

### Phase 13: Workspace & Stream Switching
**Goal**: Fast switching between workspaces and streams without modal dialogs
**Depends on**: Phase 11
**Plans**: 5 plans

Plans:
- [x] 13-01: Rust backend commands (list streams, get client spec, update client stream)
- [x] 13-02: WorkspaceSwitcher component + header label fix
- [x] 13-03: StreamSwitcher with shelve confirmation dialog
- [x] 13-04: ClientSpecDialog (read-only viewer)
- [x] 13-05: Integration polish + verification checkpoint

### Phase 14: Depot Browser
**Goal**: Full depot hierarchy with lazy loading and file operations
**Depends on**: Phase 13
**Plans**: 3 plans

Plans:
- [x] 14-01: Rust backend commands (p4_dirs, p4_depots) + TypeScript invoke wrappers
- [x] 14-02: DepotBrowser component + accordion left column layout
- [x] 14-03: Context menu operations + detail pane integration + visual verification

### Phase 15: Resolve Workflow
**Goal**: Conflict detection and external merge tool integration
**Depends on**: Phase 14
**Plans**: 2 plans

Plans:
- [x] 15-01: Rust backend resolve commands (fstat unresolved, resolve accept, launch merge tool)
- [x] 15-02: Frontend resolve UI (conflict banner, blocking overlay, context menus, submit blocking)

---

## Milestone Summary

**Key Decisions:**
- WebdriverIO v9 + tauri-driver for E2E testing
- Optimistic updates for drag-drop (cancelQueries + snapshot + rollback)
- TanStack Query refetchInterval for auto-refresh (conditional on connection + operation + window focus)
- DetailSelection discriminated union for type-safe detail pane routing
- Dimming over hiding for search filtering (preserves tree structure)
- Auto-shelve default CL on stream switch (create numbered CL, reopen, shelve)
- Lazy loading on depot folder toggle (prevents memory exhaustion)
- spawn_blocking for merge tool wait (doesn't block async runtime)

**Issues Resolved:**
- Drag-and-drop reliability (optimistic updates with rollback)
- Default CL description editing moves files to numbered CL
- Unshelve targets same changelist (not default)
- Post-operation conflict detection after unshelve
- Large depot memory exhaustion (lazy load + virtualization)
- Merge tool blocking (spawn_blocking + confirmation dialog)

**Issues Deferred:**
- E2E tests need execution against real P4 server (human_needed)
- Unshelve all for changelist (TODO in ChangelistPanel.tsx:576)
- p4_print command for Open This Revision (TODO in RevisionDetailView.tsx:43)
- p4_describe command for sibling files (TODO in RevisionDetailView.tsx:96)
- Workspace/stream switch not in operation store (auto-refresh edge case)

**Technical Debt Incurred:**
- 5 items across 4 phases (see audit report for details)

---

_For current project status, see .planning/ROADMAP.md_

---
phase: 02-core-workflows
plan: 09
type: execute
wave: 6
depends_on: ["02-08"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can sync workspace and UI shows progress without freezing"
    - "User can checkout file and see status update after server confirms"
    - "User can view pending changelists with files"
    - "User can submit changelist with description"
    - "User can revert file and see status update"
  artifacts: []
  key_links: []
---

<objective>
Verify all Phase 2 success criteria through manual testing with a real Perforce server.

Purpose: Phase 2 requires a real P4 server connection to verify. This checkpoint ensures all success criteria from ROADMAP.md are met before marking the phase complete.

Output: Verification results confirming or identifying issues with Phase 2 implementation.
</objective>

<execution_context>
@./.claude/agents/gsd-planner.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-core-workflows/02-CONTEXT.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Phase 2 implementation:
- File tree with status icons and context menu
- Changelist sidebar with drag-drop
- Sync with progress streaming and conflict detection
- Checkout, revert, submit operations
- Full layout integration
  </what-built>

  <how-to-verify>
**Prerequisites:**
- Perforce server accessible (P4PORT configured)
- Perforce client workspace configured (P4CLIENT set)
- Perforce user authenticated (P4USER set, `p4 login` done)

**Test 1: File Tree Display**
1. Run `npm run tauri dev`
2. Verify file tree shows workspace files hierarchically
3. Verify files show status icons (green for synced, blue for checked out, etc.)
4. Verify folders can expand/collapse
5. Expected: Tree displays all files with appropriate status colors

**Test 2: Sync Operation**
1. Make sure depot has files to sync (or modify something on depot)
2. Click "Sync" button in toolbar
3. Verify progress appears (files updating)
4. Verify UI remains responsive during sync (can still interact)
5. Verify file tree updates as files sync
6. Expected: Sync completes, status bar shows success, output panel shows files

**Test 3: Checkout (Edit) Operation**
1. Right-click a synced file (green icon)
2. Select "Checkout for Edit" from context menu
3. Verify operation appears in status bar
4. Verify file icon changes to blue (checked out) AFTER operation completes
5. Expected: File shows in "Pending Changes" sidebar, icon is blue

**Test 4: View Pending Changelists**
1. Check the sidebar "Pending Changes" panel
2. Verify checked-out file appears in default changelist
3. Expand changelist to see file
4. Verify file count is shown
5. Expected: Changelist shows file with correct info

**Test 5: Submit Operation**
1. Hover over changelist in sidebar, click Submit (send icon)
2. Verify dialog shows with description field
3. Enter/edit description
4. Click Submit
5. Verify operation shows in status bar
6. Verify success toast appears
7. Verify file no longer in pending changes
8. Expected: Changelist submitted, file returns to synced state

**Test 6: Revert Operation**
1. Checkout another file for edit
2. Right-click the checked-out file
3. Select "Revert" from context menu
4. Verify file returns to synced state (green icon)
5. Verify file no longer in pending changes
6. Expected: File reverted, status updated

**Test 7: Sync Cancellation**
1. Start a large sync (many files)
2. Click "Cancel" button while syncing
3. Verify sync stops
4. Verify "Cancelled" message appears
5. Expected: Sync terminates cleanly

**Test 8: Non-Blocking Verification**
1. Start a sync operation
2. During sync, try to expand/collapse folders in tree
3. Try to scroll the tree
4. Verify UI is responsive (no freezing)
5. Open DevTools Performance tab, verify no long tasks >100ms
6. Expected: UI remains responsive during all operations
  </how-to-verify>

  <resume-signal>
Type "all pass" if all tests pass.
Or describe which tests failed and what behavior was observed.
  </resume-signal>
</task>

</tasks>

<verification>
Phase 2 is complete when:
- All 8 test scenarios pass
- UI remains responsive during operations
- File status updates correctly after server confirmation
- Error handling works (test with network issues if possible)
</verification>

<success_criteria>
Per ROADMAP.md Phase 2 Success Criteria:
1. User can sync workspace from depot and UI shows progress without freezing
2. User can checkout file for editing and see status update after confirmation
3. User can view pending changelist showing all modified and checked-out files
4. User can submit changelist with description and see non-blocking progress
5. User can revert checked-out file and file returns to depot state
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-workflows/02-09-SUMMARY.md` with test results.
</output>

---
phase: 27-application-rename
plan: 03
type: execute
wave: 2
depends_on: ["27-01"]
files_modified:
  - src/components/SettingsDialog.tsx
  - src/components/MainLayout.tsx
  - src-tauri/capabilities/default.json
autonomous: true

must_haves:
  truths:
    - "Settings dialog footer displays version in format 'v0.1.0 (Alpha)'"
    - "Window title updates to 'Depot - [workspace]' when connected"
    - "Window title shows 'Depot' when disconnected"
  artifacts:
    - path: "src/components/SettingsDialog.tsx"
      provides: "Version display in settings footer"
      contains: "getVersion"
    - path: "src/components/MainLayout.tsx"
      provides: "Dynamic window title updates"
      contains: "setTitle"
    - path: "src-tauri/capabilities/default.json"
      provides: "Window title permission"
      contains: "core:window:allow-set-title"
  key_links:
    - from: "src/components/SettingsDialog.tsx"
      to: "@tauri-apps/api/app"
      via: "getVersion import"
      pattern: "getVersion.*@tauri-apps/api/app"
    - from: "src/components/MainLayout.tsx"
      to: "@tauri-apps/api/window"
      via: "getCurrentWindow import"
      pattern: "getCurrentWindow.*@tauri-apps/api/window"
---

<objective>
Add version display to Settings dialog footer and implement dynamic window title that shows "Depot - [workspace]" when connected.

Purpose: Display version info per user decision and update window title dynamically for better UX
Output: Settings shows version, window title reflects connection state
</objective>

<execution_context>
@C:\Users\a\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\a\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/27-application-rename/27-CONTEXT.md
@.planning/phases/27-application-rename/27-RESEARCH.md
@.planning/phases/27-application-rename/27-01-SUMMARY.md

Key files:
@src/components/SettingsDialog.tsx
@src/components/MainLayout.tsx
@src-tauri/capabilities/default.json
@src/stores/connectionStore.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Tauri window permission</name>
  <files>src-tauri/capabilities/default.json</files>
  <action>
    In src-tauri/capabilities/default.json:
    - Add "core:window:allow-set-title" to the permissions array

    This permission is required for Tauri 2.0 to allow window title changes via the JavaScript API.
    Add it after "core:default" in the permissions list.
  </action>
  <verify>Run `grep "core:window:allow-set-title" src-tauri/capabilities/default.json` - should show the permission</verify>
  <done>Capability file includes core:window:allow-set-title permission</done>
</task>

<task type="auto">
  <name>Task 2: Add version display to Settings dialog footer</name>
  <files>src/components/SettingsDialog.tsx</files>
  <action>
    In src/components/SettingsDialog.tsx:
    - Add import: `import { getVersion } from '@tauri-apps/api/app';`
    - Add state for version: `const [version, setVersion] = useState<string>('');`
    - In the existing useEffect that runs when `open` changes, add version fetch:
      ```typescript
      getVersion().then(setVersion);
      ```
    - Add version footer INSIDE the Form, AFTER DialogFooter but BEFORE closing </Form> tag:
      ```tsx
      {version && (
        <div className="text-xs text-muted-foreground text-center pt-2">
          v{version} (Alpha)
        </div>
      )}
      ```

    The format "v0.1.0 (Alpha)" is per user decision to set stability expectations.
    Place the footer inside the dialog content but after the buttons.
  </action>
  <verify>
    - Run `grep "getVersion" src/components/SettingsDialog.tsx` - should show import
    - Run `grep "Alpha" src/components/SettingsDialog.tsx` - should show version format
  </verify>
  <done>Settings dialog shows "v0.1.0 (Alpha)" in footer when open</done>
</task>

<task type="auto">
  <name>Task 3: Implement dynamic window title</name>
  <files>src/components/MainLayout.tsx</files>
  <action>
    In src/components/MainLayout.tsx:
    - Add import: `import { getCurrentWindow } from '@tauri-apps/api/window';`
    - Get workspace from connection store (already available via useConnectionStore)
    - Add a new useEffect that updates the window title when connection status or workspace changes:

      ```typescript
      // Update window title based on connection state
      const workspace = useConnectionStore(s => s.workspace);

      useEffect(() => {
        const updateTitle = async () => {
          const window = getCurrentWindow();
          if (workspace) {
            await window.setTitle(`Depot - ${workspace}`);
          } else {
            await window.setTitle('Depot');
          }
        };
        updateTitle();
      }, [workspace]);
      ```

    Per user decision: Window title format is "Depot - [workspace]" when connected, just "Depot" when disconnected.
  </action>
  <verify>
    - Run `grep "getCurrentWindow" src/components/MainLayout.tsx` - should show import
    - Run `grep "setTitle" src/components/MainLayout.tsx` - should show title update logic
    - Run `grep "Depot -" src/components/MainLayout.tsx` - should show title format
  </verify>
  <done>Window title updates to "Depot - [workspace]" on connection, "Depot" on disconnection</done>
</task>

</tasks>

<verification>
1. `grep "core:window:allow-set-title" src-tauri/capabilities/default.json` shows permission
2. `grep "getVersion" src/components/SettingsDialog.tsx` shows version import
3. `grep "getCurrentWindow" src/components/MainLayout.tsx` shows window import
4. `grep "setTitle" src/components/MainLayout.tsx` shows title update
5. TypeScript compilation: `npx tsc --noEmit` passes
</verification>

<success_criteria>
- Tauri capability for window title is enabled
- Settings dialog displays "v0.1.0 (Alpha)" in footer
- Window title dynamically updates based on connection state
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/27-application-rename/27-03-SUMMARY.md`
</output>
